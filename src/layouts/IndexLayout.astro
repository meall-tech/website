---
import DefaultLayout from "@/layouts/DefaultLayout.astro";
const { title, subheader, subsubheader } = Astro.props;
---

<DefaultLayout title={title}>
  <div
    class="flex flex-col h-[75vh] text-center justify-center items-center pr-10 md:pr-0"
  >
    <div class="text-[5rem] font-bold neon-text animate-on-load" transition:name="hero-logo">△_<span class="text-[4.5rem]">△</span></div>
    <h1 class="animate-on-load delay-1">{subheader}</h1>
    <h3 class="animate-on-load delay-2">{subsubheader}</h3>
    <br />
    
  </div>
</DefaultLayout>

<style>
  .neon-text {
    text-shadow: none;
  }

  .neon-text.flicker {
    animation: flicker 0.5s ease-in-out forwards;
  }

  .neon-text.pulsate {
    animation: pulsate 1.5s infinite alternate;
  }

  @keyframes flicker {
    0% {
      text-shadow: none;
    }
    18%, 22%, 25%, 53%, 57%, 100% {
      text-shadow:
        0 0 4px #fff,
        0 0 11px #fff,
        0 0 19px #fff,
        0 0 40px #0fa,
        0 0 80px #0fa,
        0 0 90px #0fa,
        0 0 100px #0fa,
        0 0 150px #0fa;
    }
    20%, 24%, 55% {
      text-shadow: none;
    }
  }

  @keyframes pulsate {
    100% {
      text-shadow: 
        0 0 4px #fff,
        0 0 11px #fff,
        0 0 19px #fff,
        0 0 40px #0fa,
        0 0 80px #0fa,
        0 0 90px #0fa,
        0 0 100px #0fa,
        0 0 150px #0fa;
    }
    0% {
      text-shadow: 
        0 0 2px #fff,
        0 0 4px #fff,
        0 0 6px #fff,
        0 0 10px #0fa,
        0 0 45px #0fa,
        0 0 55px #0fa,
        0 0 70px #0fa,
        0 0 80px #0fa;
    }
  }

  .animate-on-load {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.5s ease-out, transform 0.5s ease-out;
  }

  .animate-on-load.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .delay-1 {
    transition-delay: 0.2s;
  }

  .delay-2 {
    transition-delay: 0.4s;
  }
</style>

<script>
  function animateElements() {
    console.log("Running animations for home page");
    
    // Force repaint to ensure elements are ready for animation
    document.body.style.display = 'none';
    document.body.offsetHeight; // Force reflow
    document.body.style.display = '';
    
    // Add small delay to ensure DOM is fully ready after transition
    setTimeout(() => {
      const elements = document.querySelectorAll('.animate-on-load');
      console.log("Found elements to animate:", elements.length);
      
      elements.forEach((el) => {
        el.classList.add('is-visible');
      });
  
      const neonText = document.querySelector('.neon-text');
      if (neonText) {
        console.log("Found neon text, animating");
        setTimeout(() => {
          neonText.classList.add('flicker');
        }, 500); // Start flicker after 0.5s
  
        setTimeout(() => {
          neonText.classList.remove('flicker');
          neonText.classList.add('pulsate');
        }, 1000); // 0.5s flicker duration + 0.5s initial delay
      }
    }, 50); // Small delay to ensure DOM is ready
  }

  // Handle all possible page transition and load events
  document.addEventListener("DOMContentLoaded", animateElements);
  document.addEventListener("astro:page-load", animateElements);
  document.addEventListener("astro:after-swap", animateElements);
  
  // Reset animation classes when navigating away
  document.addEventListener("astro:before-swap", () => {
    console.log("Resetting animation classes before transition");
    const elements = document.querySelectorAll('.animate-on-load');
    elements.forEach((el) => {
      el.classList.remove('is-visible');
    });
    
    const neonText = document.querySelector('.neon-text');
    if (neonText) {
      neonText.classList.remove('flicker');
      neonText.classList.remove('pulsate');
    }
  });
</script>
